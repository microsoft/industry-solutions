/* Refactored header.scss — grouped vars, nesting, breakpoints, and deduplication */

$bp-lg: 64rem;
$bp-md: 60rem;
$bp-sm: 40rem;
$bp-xs: 28rem;

.custom-header {
  /* Themeable tokens */
  --header-gap: 0.75rem;
  --logo-height: var(--logo-header-h, 2.5rem);
  --menu-btn-padding: 0.375rem;
  --subnav-underline-thickness: 0.1875rem;
  /* Header-specific z-index tokens (pulled from header.scss) */
  --header-z-base: 9999;
  --header-z-panel: 99999;
  --header-z-menu-btn: 100001;

  /* Do NOT reassign --color-accent here; that can shadow a global value. Use a fallback at usage instead. */

  color: #fff;
  /* Public Sans is what USWDS ships; keep a robust fallback stack */
  font-family: "Public Sans", "Source Sans Pro Web", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  line-height: 1.3;
  padding-top: 1rem;

  /* Variant: darker background */
  &.bg-primary-darker {
    --header-foreground: var(--color-inverse);

    .usa-logo__text.brand {
      color: var(--header-foreground) !important;
      white-space: nowrap;
    }
  }

  /* Scoped primary-navigation rules */
  .usa-nav__primary {

    a,
    .usa-nav__link {
      color: var(--header-foreground) !important;
      text-decoration: none;
      background: transparent !important;
    }

    a,
    .usa-nav__link {

      &:hover,
      &:focus {
        background: rgba(255, 255, 255, 0.06) !important;
        color: var(--header-foreground) !important;
      }
    }
  }

  /* Removed legacy/uswds selectors that are not used by the current custom header:
     .usa-nav__close, .usa-menu-btn, .usa-logo, .usa-navbar, .usa-nav, .usa-nav-container, > .usa-nav .container
  */

  /* Small-screen overrides applied in media queries to preserve original specificity */
}

/* Layout and spacing (component styles) */
.custom-header-row-main {
  display: flex;
  align-items: center;
  gap: var(--header-gap);
  border-bottom: 1px solid rgba(255, 255, 255, 1);
  padding-top: 0.5rem;
  margin-bottom: 0.2rem;
  padding-bottom: 0.5rem;
}

.custom-brand-title {
  display: flex;
  align-items: center;
  gap: var(--header-gap);
  flex: 1 1 auto;
  min-width: 0;
}

.custom-header-brand {
  flex: 0 0 auto;
}

.custom-brand-link {
  display: inline-flex;
  align-items: center;
  text-decoration: none;
}

/* Ensure both legacy and current logo class names receive the same sizing */
.site-logo,
.custom-site-logo {
  height: var(--logo-height);
  width: auto;
  display: block;
}

.custom-header-title {
  flex: 1 1 auto;
  min-width: 0;
  overflow-wrap: anywhere;
}

.custom-site-title {
  font-style: normal;
  font-weight: 700;
  margin: 0;
  font-size: 34px;
}

.custom-site-tagline {
  margin: 0.125rem 0 0 0;
  font-size: 0.875rem;
  opacity: 0.92;
}

/* Menu button (mobile) */
.custom-menu-btn {
  flex: 0 0 auto;
  background: none;
  border: none;
  color: inherit;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  padding: var(--menu-btn-padding);
  border-radius: 0.25rem;
}

.custom-menu-btn:focus-visible,
.custom-menu-btn:focus {
  outline: 0;
  box-shadow: 0 0 0 2px #0b0c0c, 0 0 0 4px #fff;
}

/* Primary navigation */
.custom-header-nav {
  display: none;
  margin-top: 0.5rem;
}

.custom-header-nav.open {
  display: block;
}

.custom-nav-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
}

.custom-nav-item {
  margin: 0;
}

.custom-nav-item+.custom-nav-item {
  border-top: 1px solid rgba(255, 255, 255, 0.18);
}

.custom-nav-list a {
  display: inline-flex;
  align-items: center;
  padding: 0.375rem 0;
  color: inherit;
  text-decoration: none;
  border-bottom: var(--subnav-underline-thickness) solid transparent;
  transition: border-color 0.12s ease, opacity 0.12s ease;
}

/* Hover/active/focus/current underline behavior using the site accent (blue) */
.custom-nav-list a:hover,
.custom-nav-list a:focus,
.custom-nav-list a:focus-visible,
.custom-nav-list a[aria-current="page"] {
  /* Use a fallback of #0071bc if --color-accent is not defined globally */
  border-bottom-color: var(--color-accent, #0071bc);
}

.custom-nav-list a:active {
  opacity: 0.9;
}

/* Large screens (≈1024px+) */
@media (min-width: $bp-lg) {
  .custom-menu-btn {
    display: none !important;
  }

  .custom-header-nav {
    display: block !important;
    margin-top: 0.25rem;
  }

  .custom-nav-list {
    flex-direction: row;
    gap: 0;
  }

  .custom-nav-item+.custom-nav-item {
    border-top: 0;
  }

  .site-logo,
  .custom-site-logo {
    height: var(--logo-height);
  }
}

/* Responsive rules from header.scss scoped for this component */
@media (max-width: $bp-md) {
  .custom-header {
    .usa-logo__text.brand {
      display: inline-block;
      overflow: visible;
      text-overflow: unset;
      white-space: normal;
      font-size: 1.2rem;
      flex: 1 1 auto;
      min-width: 0;
    }
  }

  .custom-header-row-main {
    border-bottom: 0px;
  }
}

@media (max-width: $bp-sm) {
  .custom-header {
    .usa-logo__text.brand {
      font-size: 1rem;
      line-height: 1;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex: 1 1 auto;
      flex-wrap: wrap;
      overflow: visible;
      text-overflow: unset;
      white-space: normal;
      overflow-wrap: anywhere;
      min-width: 0;
    }
  }

  .custom-site-title {
    font-size: 1.5rem !important;
  }

  .custom-header-row-main {
    border-bottom: 0px;
  }
}

@media (max-width: $bp-xs) {
  .custom-header {
    .usa-logo__text.brand {
      display: block;
      white-space: normal;
      overflow: visible;
      text-overflow: unset;
    }
  }

  .custom-header-row-main {
    border-bottom: 0px;
  }
}